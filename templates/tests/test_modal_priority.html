<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Priorit√© des Modals</title>
    <link rel="stylesheet" href="../css/style.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f0f0f0;
        }
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .test-button {
            background: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        .test-button:hover {
            background: #45a049;
        }
        .test-button.danger {
            background: #f44336;
        }
        .test-button.danger:hover {
            background: #da190b;
        }
        .debug-info {
            background: #f9f9f9;
            padding: 10px;
            border-radius: 5px;
            font-family: monospace;
            font-size: 12px;
            margin: 10px 0;
            max-height: 200px;
            overflow-y: auto;
        }
        .z-index-info {
            background: #e7f3ff;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>üß™ Test Priorit√© des Modals</h1>
        
        <div class="z-index-info">
            <h3>Z-Index des √©l√©ments :</h3>
            <ul>
                <li><strong>Modal de combat</strong> : z-index: 1000</li>
                <li><strong>Animation de combat</strong> : z-index: 999</li>
                <li><strong>Modal content</strong> : z-index: 1001</li>
            </ul>
        </div>
        
        <div class="test-section">
            <h3>Test 1: Affichage de la Modal de Combat</h3>
            <p>V√©rifier que la modal de combat s'affiche correctement.</p>
            <button class="test-button" onclick="showCombatModal()">Afficher Modal de Combat</button>
            <button class="test-button danger" onclick="hideCombatModal()">Masquer Modal de Combat</button>
            <div id="test1-result" class="debug-info"></div>
        </div>
        
        <div class="test-section">
            <h3>Test 2: Affichage de l'Animation de Combat</h3>
            <p>V√©rifier que l'animation de combat s'affiche mais ne masque pas la modal.</p>
            <button class="test-button" onclick="showCombatAnimation()">Afficher Animation de Combat</button>
            <button class="test-button danger" onclick="hideCombatAnimation()">Masquer Animation de Combat</button>
            <div id="test2-result" class="debug-info"></div>
        </div>
        
        <div class="test-section">
            <h3>Test 3: Les Deux Simultan√©ment</h3>
            <p>V√©rifier que les deux s'affichent ensemble et que la modal reste visible.</p>
            <button class="test-button" onclick="showBoth()">Afficher les Deux</button>
            <button class="test-button danger" onclick="hideBoth()">Masquer les Deux</button>
            <div id="test3-result" class="debug-info"></div>
        </div>
        
        <div class="test-section">
            <h3>Test 4: Popup de Victoire</h3>
            <p>V√©rifier que la popup de victoire s'affiche dans la modal de combat.</p>
            <button class="test-button" onclick="showVictoryPopup()">Afficher Popup de Victoire</button>
            <div id="test4-result" class="debug-info"></div>
        </div>
        
        <div class="test-section">
            <h3>√âtat Actuel</h3>
            <div id="current-state" class="debug-info"></div>
        </div>
    </div>

    <script>
        // Test 1: Affichage de la modal de combat
        window.showCombatModal = function() {
            const combatModal = document.getElementById('combat-modal');
            if (combatModal) {
                combatModal.style.display = 'flex';
                combatModal.classList.add('active');
                
                const resultDiv = document.getElementById('test1-result');
                resultDiv.innerHTML = `
                    <strong>Modal de combat affich√©e :</strong><br>
                    Display: ${combatModal.style.display}<br>
                    Classe active: ${combatModal.classList.contains('active')}<br>
                    Z-index: ${getComputedStyle(combatModal).zIndex}<br>
                    Visible: Oui
                `;
            }
            updateCurrentState();
        };
        
        window.hideCombatModal = function() {
            const combatModal = document.getElementById('combat-modal');
            if (combatModal) {
                combatModal.style.display = 'none';
                combatModal.classList.remove('active');
                
                const resultDiv = document.getElementById('test1-result');
                resultDiv.innerHTML = `
                    <strong>Modal de combat masqu√©e :</strong><br>
                    Display: ${combatModal.style.display}<br>
                    Classe active: ${combatModal.classList.contains('active')}<br>
                    Visible: Non
                `;
            }
            updateCurrentState();
        };
        
        // Test 2: Affichage de l'animation de combat
        window.showCombatAnimation = function() {
            const animationContainer = document.getElementById('combat-animation-container');
            if (animationContainer) {
                animationContainer.style.display = 'flex';
                
                const resultDiv = document.getElementById('test2-result');
                resultDiv.innerHTML = `
                    <strong>Animation de combat affich√©e :</strong><br>
                    Display: ${animationContainer.style.display}<br>
                    Z-index: ${getComputedStyle(animationContainer).zIndex}<br>
                    Visible: Oui<br>
                    <br>
                    <strong>Modal de combat :</strong><br>
                    ${document.getElementById('combat-modal') ? 
                        `Display: ${document.getElementById('combat-modal').style.display}<br>
                         Z-index: ${getComputedStyle(document.getElementById('combat-modal')).zIndex}<br>
                         Visible: ${document.getElementById('combat-modal').style.display === 'flex' ? 'Oui' : 'Non'}` : 
                        'Modal non trouv√©e'}
                `;
            }
            updateCurrentState();
        };
        
        window.hideCombatAnimation = function() {
            const animationContainer = document.getElementById('combat-animation-container');
            if (animationContainer) {
                animationContainer.style.display = 'none';
                
                const resultDiv = document.getElementById('test2-result');
                resultDiv.innerHTML = `
                    <strong>Animation de combat masqu√©e :</strong><br>
                    Display: ${animationContainer.style.display}<br>
                    Visible: Non
                `;
            }
            updateCurrentState();
        };
        
        // Test 3: Les deux simultan√©ment
        window.showBoth = function() {
            showCombatModal();
            setTimeout(() => {
                showCombatAnimation();
                
                const resultDiv = document.getElementById('test3-result');
                const combatModal = document.getElementById('combat-modal');
                const animationContainer = document.getElementById('combat-animation-container');
                
                resultDiv.innerHTML = `
                    <strong>Les deux √©l√©ments affich√©s :</strong><br>
                    <br>
                    <strong>Modal de combat :</strong><br>
                    Display: ${combatModal ? combatModal.style.display : 'N/A'}<br>
                    Z-index: ${combatModal ? getComputedStyle(combatModal).zIndex : 'N/A'}<br>
                    Visible: ${combatModal && combatModal.style.display === 'flex' ? 'Oui' : 'Non'}<br>
                    <br>
                    <strong>Animation de combat :</strong><br>
                    Display: ${animationContainer ? animationContainer.style.display : 'N/A'}<br>
                    Z-index: ${animationContainer ? getComputedStyle(animationContainer).zIndex : 'N/A'}<br>
                    Visible: ${animationContainer && animationContainer.style.display === 'flex' ? 'Oui' : 'Non'}<br>
                    <br>
                    <strong>R√©sultat :</strong><br>
                    La modal devrait √™tre visible par-dessus l'animation
                `;
            }, 100);
        };
        
        window.hideBoth = function() {
            hideCombatModal();
            hideCombatAnimation();
            
            const resultDiv = document.getElementById('test3-result');
            resultDiv.innerHTML = `
                <strong>Les deux √©l√©ments masqu√©s :</strong><br>
                Modal et animation ferm√©es
            `;
        };
        
        // Test 4: Popup de victoire
        window.showVictoryPopup = function() {
            // D'abord afficher la modal de combat
            showCombatModal();
            
            setTimeout(() => {
                // Cr√©er une popup de victoire
                const combatModal = document.getElementById('combat-modal');
                if (combatModal) {
                    const modalBody = combatModal.querySelector('.modal-body');
                    if (modalBody) {
                        // Supprimer l'ancienne popup si elle existe
                        const oldVictoryBox = modalBody.querySelector('.victory-summary-box');
                        if (oldVictoryBox) {
                            oldVictoryBox.remove();
                        }
                        
                        // Cr√©er la nouvelle popup
                        const victoryBox = document.createElement('div');
                        victoryBox.className = 'victory-summary-box';
                        victoryBox.innerHTML = `
                            <div class="victory-summary-content">
                                <h3>üéâ Victoire !</h3>
                                <div class="victory-rewards">
                                    <div class="reward-details">
                                        <div class="reward-line">
                                            <span>Or pour la victoire :</span>
                                            <span class="reward-amount">+50 or</span>
                                        </div>
                                        <div class="reward-line">
                                            <span>Bonus √©conomie :</span>
                                            <span class="reward-amount">+10 or</span>
                                        </div>
                                        <div class="reward-total">
                                            <span><strong>Total :</strong></span>
                                            <span class="reward-amount total"><strong>+60 or</strong></span>
                                        </div>
                                    </div>
                                    <p class="rank-progression">Vous passez au rang : <strong>F</strong></p>
                                </div>
                                <div class="victory-actions">
                                    <button class="btn primary victory-continue-btn">Continuer vers le magasin</button>
                                </div>
                            </div>
                        `;
                        
                        modalBody.appendChild(victoryBox);
                        
                        // Animation d'apparition
                        setTimeout(() => {
                            victoryBox.classList.add('show');
                        }, 100);
                        
                        const resultDiv = document.getElementById('test4-result');
                        resultDiv.innerHTML = `
                            <strong>Popup de victoire cr√©√©e :</strong><br>
                            Popup trouv√©e: ${modalBody.querySelector('.victory-summary-box') ? 'Oui' : 'Non'}<br>
                            Classe show: ${victoryBox.classList.contains('show')}<br>
                            Visible: Oui
                        `;
                    }
                }
            }, 100);
        };
        
        // Mettre √† jour l'√©tat actuel
        function updateCurrentState() {
            const stateDiv = document.getElementById('current-state');
            const combatModal = document.getElementById('combat-modal');
            const animationContainer = document.getElementById('combat-animation-container');
            
            stateDiv.innerHTML = `
                <strong>√âtat actuel :</strong><br>
                <br>
                <strong>Modal de combat :</strong><br>
                Existe: ${combatModal ? 'Oui' : 'Non'}<br>
                Display: ${combatModal ? combatModal.style.display : 'N/A'}<br>
                Z-index: ${combatModal ? getComputedStyle(combatModal).zIndex : 'N/A'}<br>
                Classe active: ${combatModal ? combatModal.classList.contains('active') : 'N/A'}<br>
                <br>
                <strong>Animation de combat :</strong><br>
                Existe: ${animationContainer ? 'Oui' : 'Non'}<br>
                Display: ${animationContainer ? animationContainer.style.display : 'N/A'}<br>
                Z-index: ${animationContainer ? getComputedStyle(animationContainer).zIndex : 'N/A'}<br>
                <br>
                <strong>Popup de victoire :</strong><br>
                Pr√©sente: ${document.querySelector('.victory-summary-box') ? 'Oui' : 'Non'}
            `;
        }
        
        // Initialiser l'√©tat au chargement
        document.addEventListener('DOMContentLoaded', function() {
            updateCurrentState();
        });
    </script>
</body>
</html> 